{"name":"CaVEMan","tagline":"SNV expectation maximisation based calling algorithm aimed at detecting somatic mutations in paired (tumour/normal) samples","body":"CaVEMan\r\n======\r\n\r\nA C implementation of the CaVEMan program. Uses an expectation maximisation\r\napproach to calling single base substitutions in paired data.\r\nDesigned for use with a compute farm/cluster most steps in the program make\r\nuse of an index parameter. The split step is designed to divide the genome into\r\nchunks of adjustable size to optimise for runtime/memory usage requirements.\r\n\r\nInstallation\r\n============\r\n\r\nSee INSTALL.TXT\r\n\r\n##Prerequisites\r\n\r\n* BWA Mapped, indexed, duplicate marked/removed bam files, for both a normal and tumour sample\r\n* Reference.fasta and index\r\n* A one based bed style format file of regions to ignore during analysis (see specified format).\r\n\r\n##Optional inputs (will result in more accurate calls)\r\n\r\n* Normal and tumour copy number files (see specified format).\r\n* A normal contamination of tumour value\r\n\r\n##Processing flow\r\n\r\nCaVEMan is executed in several distinct steps in the order listed below.\r\n\r\n###Setup\r\n\r\nGenerates a config file for use with the remaining CaVEMan steps (it'll save you a lot of time typing commandline args).\r\nAlso generates a file named 'alg_bean' in the run directory.\r\n\r\n\tbin/caveman setup || ./bin/setupCaveman\r\n\tUsage: caveman setup -t tum.bam -n norm.bam -r reference.fa.fai -g ignore_regions.tab -e tum_cn.bed -j norm_cn.bed [-f path] [-l path] [-a path] [-wzu]\r\n\r\n\t-t  --tumour-bam [file]             Location of tumour bam\r\n\t-n  --normal-bam [file]             Location of normal bam\r\n\t-r  --reference-index [file]        Location of reference fasta index\r\n\t-g  --ignore-regions-file [file]    Location of tsv ignore regions file\r\n\r\n\tOptional\r\n\t-c  --config-file [file]            File to write caveman run config file [default:'./caveman.cfg.ini']\r\n\t-f  --results-folder [file]         Folder to write results [default:'./results']\r\n\t-l  --split-file [file]             File to write list of split sections [default:'./splitList']\r\n\t-a  --alg-bean-file [file]          Location to write alg-bean [default:'./alg_bean']\r\n\t-w  --include-smith-waterman        Include SW mapped reads in the analysis\r\n\t-z  --include-single-end            Use single end reads for this analysis\r\n\t-u  --include-duplicates            Include reads marked as duplicates in the analysis\r\n\t-e  --tumour-copy-no-file [file]    Location of tumour copy number bed file (if the extension is not .bed the file will \t\tbe treated as 1 based start). If no copy number file is supplied then the default cn of 2 will be used\r\n\t-j  --normal-copy-no-file [file]    Location of normal copy number bed file (if the extension is not .bed the file will \t\tbe treated as 1 based start). If no copy number file is supplied then the default cn of 2 will be used\r\n\t-h\t--help                          Display this usage information.\r\n\r\n\r\n###Split\r\n\r\nRequires one job per entry in your reference.fasta.fai file.\r\nEach job creates a list of segments to be analysed, these are determined by total read count\r\nand do not include reads from ignored regions. The size of sections can be tuned using\r\nthe -m, -c and -e parameters. Once all jobs complete successfully you will need to concatenate\r\nall split files into a single file with the name passed to the setup step in -f parameter\r\n(or splitList if you used the default).\r\n\r\n\tbin/caveman split || ./bin/splitCaveman\r\n\tUsage: caveman split -i jobindex -f path [-c int] [-m int] [-e int]\r\n\r\n\t-f --config-file file           Path to the config file produced by setup [default: 'caveman.cfg.ini'].\r\n\t-i  --index int                 Job index (e.g. from $LSB_JOBINDEX)\r\n\r\n\tOptional\r\n\t-c  --increment int             Increment to use when deciding split sizes\r\n\t-m  --max-read-count double     Proportion of read-count to allow as a max in a split section\r\n\t-e  --read-count int            Guide for maximum read count in a section\r\n\t-h\thelp                        Display this usage information.\r\n\r\n###Mstep\r\n\r\nRequires one job per entry in the merged split file. The parameter -i referes to a line in the merged split file.\r\n-a can be used to tune the size of section downloaded from bam at a time, this allows tuning\r\nof the memory footprint. The mstep will create a file for each job under the results folder\r\n(specified as a parameter in the setup step).\r\n\r\n\tbin/caveman mstep || ./bin/mstepCaveman\r\n\tUsage: caveman mstep -f config.file -i jobindex [-m int] [-a int]\r\n\r\n\t-f --config-file file                  Path to the config file produced by setup [default: 'caveman.cfg.ini'].\r\n\t-i --index int                         Job index.\r\n\r\n\tOptional\r\n\t-a --split_size int                    Size of section to retrieve at a time from bam file. Allows memory footprint tuning [default:50000].\r\n\t-m  --min-base-qual int                Minimum base quality to include in analysis [default:11]\r\n\t-h\thelp                                Display this usage information.\r\n\r\n###Merge\r\n\r\nRuns as a single job, merging all the cov_array files generated by the mstep into a file\r\nrepresenting the profile of the whole genome. The resulting file is named cov_array and stored\r\nin the root run folder. Another file named prob_array is also created.\r\n\r\n\tbin/caveman merge || ./bin/mergeCaveman\r\n\tUsage: caveman merge -f config_file [-c path] [-p path]\r\n\r\n\t-f --config-file file                Path to the config file produced by setup. [default: 'caveman.cfg.ini']\r\n\r\n\tOptional\r\n\t-c  --covariate-file filename        Location to write merged covariate array [default: covs_arr]\r\n\t-p  --probabilities-file filename    Location to write probability array [default: probs_arr]\r\n\t-h\thelp                              Display this usage information.\r\n\r\n###Estep\r\n\r\nThe final step in calling variants using CaVEMan. As was the case with the mstep, a job per\r\nentry in the merged split list is required. Copy number (-e, -j), and normal contamination (-k)\r\nare required (See default settings for advice on obtaining results if you don't have these).\r\nEach job will create several files named according to the corresponding line in the merged split file.\r\n*_muts.vcf and *_snps.vcf are the calls above the given cutoffs for somatic and SNP probabilities alike.\r\nThe *.no_analysis.bed file lists sections not analysed by caveman, due to being ignored or lacking coverage.\r\nUsing the debugoption will output another file named *.dbg.vcf containing  a line for every position\r\nin the genome that was analysed with read counts (as seen by CaVEMan) and top two probabilities\r\ncalculated.\r\n\r\n\tbin/caveman estep || ./bin/estepCaveman\r\n\tUsage: caveman estep -i jobindex [-f file] [-m int] [-k float] [-b float] [-p float] [-q float] [-x int] [-y int] [-c \tfloat] [-d float] [-a int]\r\n\r\n\t-i  --index [int]                                Job index (e.g. from $LSB_JOBINDEX)\r\n\r\n\tOptional\r\n\t-f  --config-file [file]                         Path to the config file produced by setup. [default:'caveman.cfg.ini']\r\n\t-m  --min-base-qual [int]                        Minimum base quality for inclusion of a read position [default:11]\r\n\t-c  --prior-mut-probability [float]              Prior somatic probability [default:0.000006]\r\n\t-d  --prior-snp-probability [float]              Prior germline mutant probability [default:0.000100]\r\n\t-k  --normal-contamination [float]               Normal contamination of tumour [default:0.100000]\r\n\t-b  --reference-bias [float]                     Reference bias [default:0.950000]\r\n\t-p  --mut-probability-cutoff [float]             Minimum probability call for a somatic mutant position to be output \t\t[default:0.800000]\r\n\t-q  --snp-probability-cutoff [float]             Minimum probability call for a germline mutant position to be output \t\t[default:0.950000]\r\n\t-x  --min-tum-coverage [int]                     Minimum tumour coverage for analysis of a position [default:1]\r\n\t-y  --min-norm-coverage [int]                    Minimum normal coverage for analysis of a position [default:1]\r\n\t-a  --split-size [int]                           Size of section to retrieve at a time from bam file. Allows memory \t\t\t\t\t\t\t\t footprint tuning [default:50000].\r\n\t-s  --debug                                      Adds an extra output to a debug file. Every base analysed has an \t\t\toutput\r\n\t-g  --cov-file [file]                            File location of the covariate array. [default:'covs_arr']\r\n\t-o  --prob-file [file]                           File location of the prob array. [default:'probs_arr']\r\n\t-v  --species-assembly [string]                  Species assembly (eg 37/GRCh37), required if bam header SQ lines do \t\t\t\t\t\t\t\t not contain AS and SP information.\r\n\t-w  --species [string]                           Species name (eg Human), required if bam header SQ lines do not \t\t\t\t\t\t\t\t contain AS and SP information.\r\n\t-n  --normal-copy-number [int]                   Copy number to use when filling gaps in the normal copy number file \t\t\t\t\t\t\t\t [default:2].\r\n\t-t  --tumour-copy-number [int]                   Copy number to use when filling gaps in the tumour copy number file \t\t\t\t\t\t\t\t [default:2].\r\n\t-l  --normal-protocol [string]                   Normal protocol. Ideally this should match -r but not checked \t\t\t\t\t\t\t\t\t (WGS|WGX|RNA) [default:WGS].\r\n\t-r  --tumour-protocol [string]                   Tumour protocol. Ideally this should match -l but not checked \t\t\t\t\t\t\t\t\t (WGS|WGX|RNA) [default:WGS].\r\n\t-P  --normal-platform [string]                   Normal platform. Overrides the values retrieved from bam header.\r\n\t-T  --tumour-platform [string]                   Tumour platform. Overrides the values retrieved from bam header.\r\n\t-M  --max-copy-number [int]                      Maximum copy number permitted. If exceeded the copy number for the \t\t\t\t\t\t\t\t offending region will be set to this value. [default:10].\r\n\t-h  --help                                     Display this usage information.\r\n\r\n\r\n##File Formats\r\n\r\n\r\n###Copy Number\r\n\r\nCopy number files are taken in a 1-based bed style tab separated format, or BED format if the suffix is .bed.\r\nWhere the columns are chromosome,start,stop,copynumber(integer). A separate file is required\r\nfor normal and tumour. Each file should have a copy number assigned for every region requested\r\nto be analysed (NB, CaVEMan set CN to 2 in regions where copy number is 0).\r\n\r\n\tExample:\r\n\t\t1\t0\t20000\t2\r\n\t\t2\t0\t2500\t4\r\n\t\t2\t2501\t500000\t6\r\n\r\n###Ignored regions file\r\n\r\nA 1-based bed style tab separated format file of regions to be ignored during analysis.\r\nAn example might be regions known to have extreme depth of mapped reads through mismapping.\r\n\r\n\r\n##Default Settings\r\n\r\nThere may be cases where copy number is not available. In order to extract the best results\r\nit is advised to use copy number 2 in the normal and 5 in the tumour in combination with\r\na normal contamination of 0.1 . This gives CaVEMan a broad range over which variants will\r\nbe called compared to a copy number of 2 in the tumour.\r\n\r\n---\r\n\r\nLICENCE\r\n=======\r\n\r\nCopyright (c) 2014 Genome Research Ltd.\r\n\r\nAuthor: Cancer Genome Project <cgpit@sanger.ac.uk>\r\n\r\nThis file is part of CaVEMan.\r\n\r\nCaVEMan is free software: you can redistribute it and/or modify it under\r\nthe terms of the GNU Affero General Public License as published by the Free\r\nSoftware Foundation; either version 3 of the License, or (at your option) any\r\nlater version.\r\n\r\nThis program is distributed in the hope that it will be useful, but WITHOUT\r\nANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS\r\nFOR A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\r\ndetails.\r\n\r\nYou should have received a copy of the GNU Affero General Public License\r\nalong with this program. If not, see <http://www.gnu.org/licenses/>.\r\n\r\n1. The usage of a range of years within a copyright statement contained within\r\nthis distribution should be interpreted as being equivalent to a list of years\r\nincluding the first and last year specified and all consecutive years between\r\nthem. For example, a copyright statement that reads ‘Copyright (c) 2005, 2007-\r\n2009, 2011-2012’ should be interpreted as being identical to a statement that\r\nreads ‘Copyright (c) 2005, 2007, 2008, 2009, 2011, 2012’ and a copyright\r\nstatement that reads ‘Copyright (c) 2005-2012’ should be interpreted as being\r\nidentical to a statement that reads ‘Copyright (c) 2005, 2006, 2007, 2008,\r\n2009, 2010, 2011, 2012’.\"\r\n\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}